version: "3"
services:
  kestra:
    image: kestra/kestra:latest
    ports:
      - "8080:8080"
    volumes:
      - ./flows:/app/flows
      - kestra-data:/app/storage
    environment:
      KESTRA_CONFIGURATION: |
        datasources:
          postgres:
            url: jdbc:postgresql://postgres:5432/kestra
        kestra:
          server:
            basic-auth:
              enabled: false
      # Environment variables for AI Summarizer Flow
      HUGGINGFACE_API_KEY: "hf_your_key_here"
      GITHUB_TOKEN: "your_github_token"
      GITHUB_REPO: "owner/repo"
      SLACK_TOKEN: "xoxb-your_slack_token"
      SLACK_CHANNELS: "general"
      NOTION_TOKEN: "secret_your_notion_token"

  postgres:
    image: postgres:14
    environment:
      POSTGRES_DB: kestra
      POSTGRES_USER: kestra
      POSTGRES_PASSWORD: kestra
    volumes:
      - postgres-data:/var/lib/postgresql/data

volumes:
  kestra-data:
  postgres-data:
