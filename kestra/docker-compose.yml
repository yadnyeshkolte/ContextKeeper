version: "3"
services:
  kestra:
    image: kestra/kestra:latest
    ports:
      - "8080:8080"
    volumes:
      - ./flows:/app/flows
      - ../backend:/app/backend
      - kestra-data:/app/storage
    environment:
      KESTRA_CONFIGURATION: |
        datasources:
          postgres:
            url: jdbc:postgresql://postgres:5432/kestra
        kestra:
          server:
            basic-auth:
              enabled: false
      # Environment variables for AI Summarizer Flow
      HUGGINGFACE_API_KEY: ""
      GITHUB_TOKEN: ""
      GITHUB_REPO: ""
      SLACK_TOKEN: ""
      SLACK_CHANNELS: ""
      NOTION_TOKEN: ""

  postgres:
    image: postgres:14
    environment:
      POSTGRES_DB: kestra
      POSTGRES_USER: kestra
      POSTGRES_PASSWORD: kestra
    volumes:
      - postgres-data:/var/lib/postgresql/data

volumes:
  kestra-data:
  postgres-data:
